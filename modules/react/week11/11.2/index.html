<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>11.2 Refs, Axios, Fetch, and Spinners | MAD9022</title>
    <meta name="generator" content="VuePress 1.9.8">
    
    <meta name="description" content="Fullstack: Frontend Development Course">
    
    <link rel="preload" href="/s2024/assets/css/0.styles.0189e570.css" as="style"><link rel="preload" href="/s2024/assets/js/app.800de6cb.js" as="script"><link rel="preload" href="/s2024/assets/js/2.65264708.js" as="script"><link rel="preload" href="/s2024/assets/js/44.8db11b89.js" as="script"><link rel="preload" href="/s2024/assets/js/9.005e1e8c.js" as="script"><link rel="preload" href="/s2024/assets/js/11.87711128.js" as="script"><link rel="prefetch" href="/s2024/assets/js/10.912d3f44.js"><link rel="prefetch" href="/s2024/assets/js/12.1ad3b3b9.js"><link rel="prefetch" href="/s2024/assets/js/13.5c6eca3c.js"><link rel="prefetch" href="/s2024/assets/js/14.a39ca56d.js"><link rel="prefetch" href="/s2024/assets/js/15.fea1e72e.js"><link rel="prefetch" href="/s2024/assets/js/16.6b8223ef.js"><link rel="prefetch" href="/s2024/assets/js/17.db7cf2f4.js"><link rel="prefetch" href="/s2024/assets/js/18.7759db48.js"><link rel="prefetch" href="/s2024/assets/js/19.bb0f2052.js"><link rel="prefetch" href="/s2024/assets/js/20.3f3d5c16.js"><link rel="prefetch" href="/s2024/assets/js/21.23f944a3.js"><link rel="prefetch" href="/s2024/assets/js/22.32b2777d.js"><link rel="prefetch" href="/s2024/assets/js/23.aa560bd2.js"><link rel="prefetch" href="/s2024/assets/js/24.1160513f.js"><link rel="prefetch" href="/s2024/assets/js/25.257a77d2.js"><link rel="prefetch" href="/s2024/assets/js/26.9c34cefb.js"><link rel="prefetch" href="/s2024/assets/js/27.b2ff0a06.js"><link rel="prefetch" href="/s2024/assets/js/28.d09f9311.js"><link rel="prefetch" href="/s2024/assets/js/29.a0941762.js"><link rel="prefetch" href="/s2024/assets/js/3.544714c7.js"><link rel="prefetch" href="/s2024/assets/js/30.47ebd370.js"><link rel="prefetch" href="/s2024/assets/js/31.ece81fbc.js"><link rel="prefetch" href="/s2024/assets/js/32.ae206ed9.js"><link rel="prefetch" href="/s2024/assets/js/33.9514a6a6.js"><link rel="prefetch" href="/s2024/assets/js/34.583d401c.js"><link rel="prefetch" href="/s2024/assets/js/35.e656cbcf.js"><link rel="prefetch" href="/s2024/assets/js/36.cacc60df.js"><link rel="prefetch" href="/s2024/assets/js/37.1d4e63ca.js"><link rel="prefetch" href="/s2024/assets/js/38.4711b180.js"><link rel="prefetch" href="/s2024/assets/js/39.28fe2c35.js"><link rel="prefetch" href="/s2024/assets/js/4.a59aad47.js"><link rel="prefetch" href="/s2024/assets/js/40.7a728e12.js"><link rel="prefetch" href="/s2024/assets/js/41.102054ba.js"><link rel="prefetch" href="/s2024/assets/js/42.e4927ef8.js"><link rel="prefetch" href="/s2024/assets/js/43.991ea947.js"><link rel="prefetch" href="/s2024/assets/js/45.8da8f59f.js"><link rel="prefetch" href="/s2024/assets/js/46.e4ae4586.js"><link rel="prefetch" href="/s2024/assets/js/47.3a64f81f.js"><link rel="prefetch" href="/s2024/assets/js/48.85a59034.js"><link rel="prefetch" href="/s2024/assets/js/49.d9dd3379.js"><link rel="prefetch" href="/s2024/assets/js/5.6426ebe4.js"><link rel="prefetch" href="/s2024/assets/js/50.51e2c9f2.js"><link rel="prefetch" href="/s2024/assets/js/51.bcc581ae.js"><link rel="prefetch" href="/s2024/assets/js/52.42daf800.js"><link rel="prefetch" href="/s2024/assets/js/6.2beeeb0e.js"><link rel="prefetch" href="/s2024/assets/js/7.64cbf74e.js"><link rel="prefetch" href="/s2024/assets/js/8.e15ce9b2.js">
    <link rel="stylesheet" href="/s2024/assets/css/0.styles.0189e570.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/s2024/" class="home-link router-link-active"><img src="/s2024/mad-d-logo-sm.png" alt="MAD9022" class="logo"> <span class="site-name can-hide">MAD9022</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/s2024/overview/" class="nav-link">
  Overview
</a></div><div class="nav-item"><a href="/s2024/assignments/" class="nav-link">
  Deliverables
</a></div><div class="nav-item"><a href="/s2024/resources/" class="nav-link">
  Resources
</a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/s2024/overview/" class="nav-link">
  Overview
</a></div><div class="nav-item"><a href="/s2024/assignments/" class="nav-link">
  Deliverables
</a></div><div class="nav-item"><a href="/s2024/resources/" class="nav-link">
  Resources
</a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Hybrid</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>PWA</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>React</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/s2024/modules/react/week9/9.1/" class="sidebar-link">9.1: React Concepts</a></li><li><a href="/s2024/modules/react/week9/9.2/" class="sidebar-link">9.2: React Setup</a></li><li><a href="/s2024/modules/react/week10/10.1/" class="sidebar-link">10.1: JSX &amp; Components</a></li><li><a href="/s2024/modules/react/week10/10.2/" class="sidebar-link">10.2: Conditional Rendering, Data, and State</a></li><li><a href="/s2024/modules/react/week11/11.1/" class="sidebar-link">11.1: Synthetic Events and Props</a></li><li><a href="/s2024/modules/react/week11/11.2/" aria-current="page" class="active sidebar-link">11.2: Refs, Axios, Fetch, and Spinners</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/s2024/modules/react/week11/11.2/#refs" class="sidebar-link">Refs</a></li><li class="sidebar-sub-header"><a href="/s2024/modules/react/week11/11.2/#basic-fetch" class="sidebar-link">Basic Fetch</a></li><li class="sidebar-sub-header"><a href="/s2024/modules/react/week11/11.2/#axios" class="sidebar-link">Axios</a></li><li class="sidebar-sub-header"><a href="/s2024/modules/react/week11/11.2/#spinners-loaders" class="sidebar-link">Spinners &amp; Loaders</a></li><li class="sidebar-sub-header"><a href="/s2024/modules/react/week11/11.2/#hooks-with-fetching" class="sidebar-link">Hooks with Fetching</a></li><li class="sidebar-sub-header"><a href="/s2024/modules/react/week11/11.2/#lazy-loading-and-code-splitting" class="sidebar-link">Lazy Loading and Code Splitting</a></li><li class="sidebar-sub-header"><a href="/s2024/modules/react/week11/11.2/#what-to-do-this-week" class="sidebar-link">What to do this week</a></li></ul></li><li><a href="/s2024/modules/react/week12/12.1/" class="sidebar-link">12.1: NextJS Intro</a></li><li><a href="/s2024/modules/react/week12/12.2/" class="sidebar-link">12.2: NextJS Routing</a></li><li><a href="/s2024/modules/react/week13/13.1/" class="sidebar-link">13.1: NextJS APIs, Actions, &amp; Middleware</a></li><li><a href="/s2024/modules/react/week13/13.2/" class="sidebar-link">13.2: Styling and Theming</a></li><li><a href="/s2024/modules/react/week14/14.1/" class="sidebar-link">14.1: TypeScript and Pair Programming</a></li><li><a href="/s2024/modules/react/week14/14.2/" class="sidebar-link">14.2: Authentication</a></li><li><a href="/s2024/modules/react/week15/" class="sidebar-link">15: NextJS Project</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><header><div class="section-title blue">
    React | NextJS
  </div> <h1>11.2 Refs, Axios, Fetch, and Spinners</h1> <div class="underdev no">Module Still Under Development</div></header> <h2 id="refs"><a href="#refs" class="header-anchor">#</a> Refs</h2> <p>One of the guiding principles of working in React is that we do not make direct changes to the DOM. We let the React rendering engine handle all the updates to the DOM.</p> <p>For those rare times when you really need to have reference to a DOM element, React has <code>Ref</code>s. The old version of React uses <code>createRef</code> to create a reference object.</p> <p>The latest versions of React have a <code>useRef</code> hook. The newer version of <code>Ref</code>s that use the hook let us create references for any mutatable object, not just DOM elements.</p> <p>When you create a <code>Ref</code> you are creating an Object that will be maintained for the life of the component. This means even when state and prop values change and React updates the DOM, as long as the
component has not been removed from the page, the reference will maintain its value. Remember that Objects in JavaScript exist and are passed around as references. We call the <code>useRef</code> method to
create our reference object and pass it an initial value.</p> <p>The reference object it creates will have a <code>current</code> property that will hold the value of the reference.</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">const</span> myRef <span class="token operator">=</span> <span class="token function">useRef</span><span class="token punctuation">(</span><span class="token number">123</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//this is a basic reference object</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>myRef<span class="token punctuation">.</span>current<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>A more common use for a reference it to hold the DOM element reference. To do this, we create a reference object with a <code>null</code> value. Then we use a <code>ref</code> attribute inside the JSX element that we want
to track.</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">function</span> <span class="token function">MyComponent</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> myElem <span class="token operator">=</span> <span class="token function">useRef</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">function</span> <span class="token function">doFocus</span><span class="token punctuation">(</span><span class="token parameter">ev</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">//call this function when button is clicked</span>
    <span class="token comment">//use the reference myElem</span>
    <span class="token comment">//its .current property references the input element</span>
    myElem<span class="token punctuation">.</span>current<span class="token punctuation">.</span><span class="token function">focus</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">return</span> <span class="token punctuation">(</span>
    <span class="token operator">&lt;</span><span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>input ref<span class="token operator">=</span><span class="token punctuation">{</span>myElem<span class="token punctuation">}</span> type<span class="token operator">=</span><span class="token string">&quot;text&quot;</span> <span class="token operator">/</span><span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>button onClick<span class="token operator">=</span><span class="token punctuation">{</span>doFocus<span class="token punctuation">}</span><span class="token operator">&gt;</span>Focus the input<span class="token operator">&lt;</span><span class="token operator">/</span>button<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span><span class="token operator">&gt;</span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br></div></div><div title="Using refs, createRef, and useRef" class="video-player"><iframe width="560" height="315" src="https://www.youtube.com/embed/VwdPy4xcHNw" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; fullscreen" allowfullscreen="allowfullscreen"></iframe></div> <h2 id="basic-fetch"><a href="#basic-fetch" class="header-anchor">#</a> Basic Fetch</h2> <p>Keep in mind that everything that we are doing in React is still just JavaScript. Any code that you wrote in first year can still be used in your React app. We are simply using the React framework,
which is really just a whole bunch of functions and objects that have been written for us to save time.</p> <p>If you want to make a fetch call, you can do it still. Put it in a function and call your function from a JSX Synthetic event.</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">function</span> <span class="token function">Parent</span><span class="token punctuation">(</span><span class="token parameter">props</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> <span class="token punctuation">[</span>data<span class="token punctuation">,</span> setData<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">function</span> <span class="token function">getData</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">fetch</span><span class="token punctuation">(</span>url<span class="token punctuation">)</span>
      <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">resp</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>resp<span class="token punctuation">.</span>ok<span class="token punctuation">)</span> <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">Failed to fetch. HTTP Status code </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>resp<span class="token punctuation">.</span>status<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">.</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> resp<span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span>
      <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span>setData<span class="token punctuation">)</span>
      <span class="token punctuation">.</span><span class="token function">catch</span><span class="token punctuation">(</span>console<span class="token punctuation">.</span>warn<span class="token punctuation">)</span>
      <span class="token punctuation">.</span><span class="token function">finally</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token comment">//runs after success or failure</span>
        <span class="token comment">//clear spinners and loaders here</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">//simplified function without proper error handling</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">return</span> <span class="token operator">&lt;</span>button onClick<span class="token operator">=</span><span class="token punctuation">{</span>getData<span class="token punctuation">}</span><span class="token operator">&gt;</span>Click to Fetch Data<span class="token operator">&lt;</span><span class="token operator">/</span>button<span class="token operator">&gt;</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br></div></div><p>In the example above, we are using React to create a state variable, to turn JSX into DOM, and to connect the Synthetic <code>onClick</code> to an actual DOM click event. But it is all still just JavaScript.</p> <h2 id="axios"><a href="#axios" class="header-anchor">#</a> Axios</h2> <p>Axios is a library that can be used to make fetch calls. It was developed before <code>fetch</code> was standard and has a syntax that is similar but a bit simpler than <code>fetch</code>. It provides a standard way to
handle failures etc.</p> <p>Axios is an alternative to using fetch. It is up to you whether or not you use it. One advantage that Axios has, beyond the simplified syntax, is the ability to cancel / abort a fetch call. If you are
building an app that makes many repeated API calls to the same end point, and you would like to abort older calls in place of new ones, then Axios would be a good library to include in your project.</p> <p><a href="https://axios-http.com/docs/intro" target="_blank" rel="noopener noreferrer">Here is the website for Axios<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p>You will need to use <code>npm</code> to install axios before you use it.</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token function">npm</span> <span class="token function">install</span> axios
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>Axios has been used with NodeJS server-side apps for many years. This was because NodeJS had no built-in <code>fetch</code> method. The two main options were <code>node-fetch</code> and <code>axios</code>. For this reason, the
examples in the website use the older <code>require()</code> syntax.</p> <p>For our app, which runs in the browser, we will be using the import syntax.</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">import</span> axios <span class="token keyword">from</span> <span class="token string">'axios'</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>Axios has a series of methods that match the HTTP methods - get, post, delete, etc.</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code>axios
  <span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>url<span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">response</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// handle success</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>response<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">catch</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">error</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// handle error</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>error<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// always executed follow up</span>
    <span class="token comment">// this would be where you dispose of your spinners</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div><div title="Axios and Spinners" class="video-player"><iframe width="560" height="315" src="https://www.youtube.com/embed/_JOgbQGbH_Q" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; fullscreen" allowfullscreen="allowfullscreen"></iframe></div> <h2 id="spinners-loaders"><a href="#spinners-loaders" class="header-anchor">#</a> Spinners &amp; Loaders</h2> <p>A spinner or loader is a UI element that you display on screen to distract users from the fact that they have to wait for some content. It lets them know that the app has not failed but rather it is
busy doing something for them.</p> <blockquote><p>Spinners are a critical part of good UX.</p></blockquote> <p>You can make a spinner out of any HTML or SVG that you want. CSS is a good choice to animate it.</p> <p>At the most basic, you can have a text element that says <code>Loading</code> and add a CSS looped animation that just cycles the opacity between 10% and 100%.</p> <p>Here is a short tutorial to give you some inspiration for building your own spinners.</p> <div title="Build your own Spinners and Loaders" class="video-player"><iframe width="560" height="315" src="https://www.youtube.com/embed/HQBJZK1TK6A" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; fullscreen" allowfullscreen="allowfullscreen"></iframe></div> <h2 id="hooks-with-fetching"><a href="#hooks-with-fetching" class="header-anchor">#</a> Hooks with Fetching</h2> <p>As was already discussed in the previous module on hooks, we can use the <code>useEffect</code> hook to call on any asynchronous function that we need. <code>fetch</code> is a perfect example.</p> <p>The elements for any fetch &amp; display component in React are:</p> <ol><li>Create a state variable to hold the results array with <code>useState</code>, with a default value of <code>null</code>.</li> <li>Create a boolean state variable with <code>useState</code> to use in monitoring if a fetch is happening.</li> <li>In your Component <code>return</code> check the boolean state variable to know if you are still fetching and need to display a spinner.</li> <li>In your Component <code>return</code> check if the results array state variable is <code>null</code>, <code>[]</code>, or has an array length &gt; 0.</li> <li>If the results array is <code>null</code>, show nothing in the list. <code>null</code> means no fetch yet.</li> <li>If the results array is an empty array, show a default message in the list about no content.</li> <li>If the results array has a <code>length &gt; 0</code>, use <code>results.map()</code> to build your list output.</li> <li>Add a <code>useEffect</code> function to initiate the <code>fetch</code>.</li> <li>Add an empty array as the second parameter for <code>useEffect</code> to be sure that it only runs on initial render.</li></ol> <p>Here is a basic example of all those elements, without using Axios or a real url.</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> useState<span class="token punctuation">,</span> useEffect <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'react'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> ListItem <span class="token keyword">from</span> <span class="token string">'./ListItem.js'</span><span class="token punctuation">;</span> <span class="token comment">//the React Element to display each data item</span>
<span class="token keyword">import</span> Spinner <span class="token keyword">from</span> <span class="token string">'./Spinner.js'</span><span class="token punctuation">;</span> <span class="token comment">//a spinner for my app</span>
<span class="token keyword">import</span> MessageBox<span class="token punctuation">,</span> <span class="token punctuation">{</span> displayError <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'./MessageBox.js'</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">function</span> <span class="token function">List</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> <span class="token punctuation">[</span>results<span class="token punctuation">,</span> setResults<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> <span class="token punctuation">[</span>isFetching<span class="token punctuation">,</span> setIsFetching<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//so it shows the spinner as it renders</span>

  <span class="token function">useEffect</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token function">fetch</span><span class="token punctuation">(</span>url<span class="token punctuation">)</span>
      <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">resp</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> resp<span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
      <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">data</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token comment">//stop the spinner and show the data</span>
        <span class="token function">setIsFetching</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">setResults</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//assuming data is an array</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span>
      <span class="token punctuation">.</span><span class="token function">catch</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">err</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token function">displayError</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">setIsFetching</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">return</span> <span class="token punctuation">(</span>
    <span class="token operator">&lt;</span><span class="token operator">&gt;</span>
      <span class="token punctuation">{</span>isFetching <span class="token operator">&amp;&amp;</span> <span class="token operator">&lt;</span>Spinner <span class="token operator">/</span><span class="token operator">&gt;</span><span class="token punctuation">}</span>
      <span class="token punctuation">{</span>results <span class="token operator">&amp;&amp;</span> <span class="token operator">&lt;</span>ul<span class="token operator">&gt;</span><span class="token punctuation">{</span>results<span class="token punctuation">.</span>length <span class="token operator">===</span> <span class="token number">0</span> <span class="token operator">?</span> <span class="token operator">&lt;</span>ListItem txt<span class="token operator">=</span><span class="token string">&quot;No results&quot;</span> <span class="token operator">/</span><span class="token operator">&gt;</span> <span class="token operator">:</span> results<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">item</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token operator">&lt;</span>ListItem key<span class="token operator">=</span><span class="token punctuation">{</span>item<span class="token punctuation">.</span>id<span class="token punctuation">}</span> txt<span class="token operator">=</span><span class="token punctuation">{</span>item<span class="token punctuation">.</span>name<span class="token punctuation">}</span> <span class="token operator">/</span><span class="token operator">&gt;</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>ul<span class="token operator">&gt;</span><span class="token punctuation">}</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span><span class="token operator">&gt;</span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">//the ListItem would be as follows</span>
<span class="token keyword">function</span> <span class="token function">ListItem</span><span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> txt <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token operator">&lt;</span>li<span class="token operator">&gt;</span><span class="token punctuation">{</span>txt<span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>li<span class="token operator">&gt;</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">//Sample Spinner with CSS that animates it</span>
<span class="token keyword">function</span> <span class="token function">Spinner</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token operator">&lt;</span>h1 className<span class="token operator">=</span><span class="token string">&quot;pulse&quot;</span><span class="token operator">&gt;</span>Loading<span class="token operator">...</span><span class="token operator">&lt;</span><span class="token operator">/</span>h1<span class="token operator">&gt;</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br></div></div><p>The <code>&lt;Spinner&gt;</code> is only displayed on screen when <code>isFetching</code> is <code>true</code>. When the <code>Spinner</code> disappears, the <code>&lt;ul&gt;</code> is added. As long as there are items in the <code>results</code> Array then the <code>&lt;ListItem&gt;s</code>
are generated. The <code>name</code> property is extracted from each object in the <code>results</code> Array and passed to <code>&lt;ListItem&gt;</code> through <code>props</code>.</p> <h2 id="lazy-loading-and-code-splitting"><a href="#lazy-loading-and-code-splitting" class="header-anchor">#</a> Lazy Loading and Code Splitting</h2> <p>Lazy Loading is the ability to wait until a component is needed before loading its modules and imports. Imagine that you build a web app with React that was built from 40 different components. 20 of
them get viewed all the time and the other 20 are only used infrequently.</p> <p>Instead of loading all of those components and modules into memory, along with all their data, why not wait until the user clicks on a <code>Link</code> to actually load any of them.</p> <p>To accomplish this we use a method called <code>React.lazy()</code> as part of the <code>import</code>. The lazy method accepts another function that does the import.</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">//instead of the standard</span>
<span class="token keyword">import</span> Thing <span class="token keyword">from</span> <span class="token string">'./Thing.js'</span><span class="token punctuation">;</span>

<span class="token comment">//we create a variable and assign it the result of a function</span>
<span class="token comment">// which does the dynamic import</span>
<span class="token keyword">const</span> Thing <span class="token operator">=</span> React<span class="token punctuation">.</span><span class="token function">lazy</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token keyword">import</span><span class="token punctuation">(</span><span class="token string">'./Thing.js'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p>This uses the JavaScript dynamic import method.</p> <div title="dynamic imports in JavaScript" class="video-player"><iframe width="560" height="315" src="https://www.youtube.com/embed/IhWpL0g3QME" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; fullscreen" allowfullscreen="allowfullscreen"></iframe></div> <p>In conjunction with the lazy import we need to have a fallback for the component. We need something to show WHILE the dynamic import is happening. The fallback is creating by using the React
<code>&lt;Suspense&gt;</code> component.</p> <p>To use the <code>&lt;Suspense&gt;</code> component, we need to import it first. Then it will wrap the component being lazy loaded.</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">import</span> React<span class="token punctuation">,</span> <span class="token punctuation">{</span> Suspense <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'react'</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> Things <span class="token operator">=</span> React<span class="token punctuation">.</span><span class="token function">lazy</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token keyword">import</span><span class="token punctuation">(</span><span class="token string">'./Things.js'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">function</span> <span class="token function">MyComponent</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token punctuation">(</span>
    <span class="token operator">&lt;</span>div<span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>Suspense fallback<span class="token operator">=</span><span class="token punctuation">{</span><span class="token operator">&lt;</span>div<span class="token operator">&gt;</span>Loading<span class="token operator">...</span><span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span><span class="token punctuation">}</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>Things <span class="token operator">/</span><span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span><span class="token operator">/</span>Suspense<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><div title="React Lazy Loading and Code Splitting" class="video-player"><iframe width="560" height="315" src="https://www.youtube.com/embed/nks5rQEZsQg" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; fullscreen" allowfullscreen="allowfullscreen"></iframe></div> <h2 id="what-to-do-this-week"><a href="#what-to-do-this-week" class="header-anchor">#</a> What to do this week</h2> <div class="custom-block warning"><p class="custom-block-title">TODO Things to do before next week.</p> <ul><li>Read all the content from <code>Modules 11.1, 11.2, and 12.1</code>.</li> <li>Complete the <a href="/s2024/assignments/assign/">React App Assignment</a>.</li> <li>Keep watching the <a href="https://www.youtube.com/watch?v=IkkzjbdIOBM&amp;list=PLyuRouwmQCjmMfs-HOsDGoaN6JiYrC6Ms" target="_blank" rel="noopener noreferrer">React in 2021 Video Tutorial Playlist<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div></div> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">Last Updated:</span> <span class="time">5/8/2024, 9:34:41 PM</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/s2024/modules/react/week11/11.1/" class="prev">
        11.1: Synthetic Events and Props
      </a></span> <span class="next"><a href="/s2024/modules/react/week12/12.1/">
        12.1: NextJS Intro
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"><!----></div></div>
    <script src="/s2024/assets/js/app.800de6cb.js" defer></script><script src="/s2024/assets/js/2.65264708.js" defer></script><script src="/s2024/assets/js/44.8db11b89.js" defer></script><script src="/s2024/assets/js/9.005e1e8c.js" defer></script><script src="/s2024/assets/js/11.87711128.js" defer></script>
  </body>
</html>
