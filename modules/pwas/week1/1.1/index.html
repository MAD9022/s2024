<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>1.1 Promises &amp; Fetch | MAD9022</title>
    <meta name="generator" content="VuePress 1.9.8">
    
    <meta name="description" content="Fullstack: Frontend Development Course">
    
    <link rel="preload" href="/s2024/assets/css/0.styles.0189e570.css" as="style"><link rel="preload" href="/s2024/assets/js/app.800de6cb.js" as="script"><link rel="preload" href="/s2024/assets/js/2.65264708.js" as="script"><link rel="preload" href="/s2024/assets/js/32.ae206ed9.js" as="script"><link rel="preload" href="/s2024/assets/js/9.005e1e8c.js" as="script"><link rel="preload" href="/s2024/assets/js/11.87711128.js" as="script"><link rel="prefetch" href="/s2024/assets/js/10.912d3f44.js"><link rel="prefetch" href="/s2024/assets/js/12.1ad3b3b9.js"><link rel="prefetch" href="/s2024/assets/js/13.5c6eca3c.js"><link rel="prefetch" href="/s2024/assets/js/14.a39ca56d.js"><link rel="prefetch" href="/s2024/assets/js/15.fea1e72e.js"><link rel="prefetch" href="/s2024/assets/js/16.6b8223ef.js"><link rel="prefetch" href="/s2024/assets/js/17.db7cf2f4.js"><link rel="prefetch" href="/s2024/assets/js/18.7759db48.js"><link rel="prefetch" href="/s2024/assets/js/19.bb0f2052.js"><link rel="prefetch" href="/s2024/assets/js/20.3f3d5c16.js"><link rel="prefetch" href="/s2024/assets/js/21.23f944a3.js"><link rel="prefetch" href="/s2024/assets/js/22.32b2777d.js"><link rel="prefetch" href="/s2024/assets/js/23.aa560bd2.js"><link rel="prefetch" href="/s2024/assets/js/24.1160513f.js"><link rel="prefetch" href="/s2024/assets/js/25.257a77d2.js"><link rel="prefetch" href="/s2024/assets/js/26.9c34cefb.js"><link rel="prefetch" href="/s2024/assets/js/27.b2ff0a06.js"><link rel="prefetch" href="/s2024/assets/js/28.d09f9311.js"><link rel="prefetch" href="/s2024/assets/js/29.a0941762.js"><link rel="prefetch" href="/s2024/assets/js/3.544714c7.js"><link rel="prefetch" href="/s2024/assets/js/30.47ebd370.js"><link rel="prefetch" href="/s2024/assets/js/31.ece81fbc.js"><link rel="prefetch" href="/s2024/assets/js/33.9514a6a6.js"><link rel="prefetch" href="/s2024/assets/js/34.583d401c.js"><link rel="prefetch" href="/s2024/assets/js/35.e656cbcf.js"><link rel="prefetch" href="/s2024/assets/js/36.cacc60df.js"><link rel="prefetch" href="/s2024/assets/js/37.1d4e63ca.js"><link rel="prefetch" href="/s2024/assets/js/38.4711b180.js"><link rel="prefetch" href="/s2024/assets/js/39.28fe2c35.js"><link rel="prefetch" href="/s2024/assets/js/4.a59aad47.js"><link rel="prefetch" href="/s2024/assets/js/40.7a728e12.js"><link rel="prefetch" href="/s2024/assets/js/41.102054ba.js"><link rel="prefetch" href="/s2024/assets/js/42.e4927ef8.js"><link rel="prefetch" href="/s2024/assets/js/43.991ea947.js"><link rel="prefetch" href="/s2024/assets/js/44.8db11b89.js"><link rel="prefetch" href="/s2024/assets/js/45.8da8f59f.js"><link rel="prefetch" href="/s2024/assets/js/46.e4ae4586.js"><link rel="prefetch" href="/s2024/assets/js/47.3a64f81f.js"><link rel="prefetch" href="/s2024/assets/js/48.85a59034.js"><link rel="prefetch" href="/s2024/assets/js/49.d9dd3379.js"><link rel="prefetch" href="/s2024/assets/js/5.6426ebe4.js"><link rel="prefetch" href="/s2024/assets/js/50.51e2c9f2.js"><link rel="prefetch" href="/s2024/assets/js/51.bcc581ae.js"><link rel="prefetch" href="/s2024/assets/js/52.42daf800.js"><link rel="prefetch" href="/s2024/assets/js/6.2beeeb0e.js"><link rel="prefetch" href="/s2024/assets/js/7.64cbf74e.js"><link rel="prefetch" href="/s2024/assets/js/8.e15ce9b2.js">
    <link rel="stylesheet" href="/s2024/assets/css/0.styles.0189e570.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/s2024/" class="home-link router-link-active"><img src="/s2024/mad-d-logo-sm.png" alt="MAD9022" class="logo"> <span class="site-name can-hide">MAD9022</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/s2024/overview/" class="nav-link">
  Overview
</a></div><div class="nav-item"><a href="/s2024/assignments/" class="nav-link">
  Deliverables
</a></div><div class="nav-item"><a href="/s2024/resources/" class="nav-link">
  Resources
</a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/s2024/overview/" class="nav-link">
  Overview
</a></div><div class="nav-item"><a href="/s2024/assignments/" class="nav-link">
  Deliverables
</a></div><div class="nav-item"><a href="/s2024/resources/" class="nav-link">
  Resources
</a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Hybrid</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>PWA</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/s2024/modules/pwas/week1/1.1/" aria-current="page" class="active sidebar-link">1.1: Promises &amp; Fetch</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/s2024/modules/pwas/week1/1.1/#introductory-topics" class="sidebar-link">Introductory Topics</a></li><li class="sidebar-sub-header"><a href="/s2024/modules/pwas/week1/1.1/#promises" class="sidebar-link">Promises</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/s2024/modules/pwas/week1/1.1/#async-await" class="sidebar-link">Async Await</a></li><li class="sidebar-sub-header"><a href="/s2024/modules/pwas/week1/1.1/#functions-and-promises" class="sidebar-link">Functions and Promises</a></li><li class="sidebar-sub-header"><a href="/s2024/modules/pwas/week1/1.1/#promise-methods" class="sidebar-link">Promise Methods</a></li></ul></li><li class="sidebar-sub-header"><a href="/s2024/modules/pwas/week1/1.1/#fetch" class="sidebar-link">Fetch</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/s2024/modules/pwas/week1/1.1/#requests-and-responses" class="sidebar-link">Requests and Responses</a></li><li class="sidebar-sub-header"><a href="/s2024/modules/pwas/week1/1.1/#json-vs-js" class="sidebar-link">JSON vs JS</a></li><li class="sidebar-sub-header"><a href="/s2024/modules/pwas/week1/1.1/#url-objects" class="sidebar-link">URL objects</a></li><li class="sidebar-sub-header"><a href="/s2024/modules/pwas/week1/1.1/#files" class="sidebar-link">Files</a></li></ul></li><li class="sidebar-sub-header"><a href="/s2024/modules/pwas/week1/1.1/#todo-this-week" class="sidebar-link">ToDo This Week</a></li></ul></li><li><a href="/s2024/modules/pwas/week1/1.2/" class="sidebar-link">1.2: Git &amp; Pull Requests</a></li><li><a href="/s2024/modules/pwas/week2/2.1/" class="sidebar-link">2.1: Web Storage, Cookies, &amp; Cache</a></li><li><a href="/s2024/modules/pwas/week2/2.2/" class="sidebar-link">2.2: Cache, Files &amp; Responses</a></li><li><a href="/s2024/modules/pwas/week3/3.1/" class="sidebar-link">3.1: Storage &amp; Data Manipulation</a></li><li><a href="/s2024/modules/pwas/week3/3.2/" class="sidebar-link">3.2: Intro to Workers</a></li><li><a href="/s2024/modules/pwas/week4/4.1/" class="sidebar-link">4.1: Service Workers</a></li><li><a href="/s2024/modules/pwas/week4/4.2/" class="sidebar-link">4.2: Messaging &amp; Screen APIs</a></li><li><a href="/s2024/modules/pwas/week5/5.1/" class="sidebar-link">5.1: Intro to PWA</a></li><li><a href="/s2024/modules/pwas/week5/5.2/" class="sidebar-link">5.2: Audits, Offline Status, &amp; Service Worker Methods</a></li><li><a href="/s2024/modules/pwas/week6/6.1/" class="sidebar-link">6.1: PWA Concept Review</a></li><li><a href="/s2024/modules/pwas/week6/6.2/" class="sidebar-link">6.2: Web App Hosting</a></li><li><a href="/s2024/modules/pwas/week7/7.1/" class="sidebar-link">7.1: PWA Project</a></li><li><a href="/s2024/modules/pwas/week7/7.2/" class="sidebar-link">7.2: PWA Project</a></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>React</span> <span class="arrow right"></span></p> <!----></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><header><div class="section-title red">
    PWA
  </div> <h1>1.1 Promises &amp; Fetch</h1> <div class="underdev no">Module Still Under Development</div></header> <h2 id="introductory-topics"><a href="#introductory-topics" class="header-anchor">#</a> Introductory Topics</h2> <p>These are the topics that we will be discussing in the first class.</p> <ul><li>Course Topics</li> <li>Workload</li> <li>Assignments and Deliverables</li> <li>Hybrid portion of course</li> <li>The connection between MAD9124 and MAD9022</li> <li>Slack channel and workspace</li> <li>Plagiarism</li> <li>Chatgpt and code pilot</li> <li>Promises</li> <li>Fetch, Http Request and Response, Files, and URLs</li></ul> <h2 id="promises"><a href="#promises" class="header-anchor">#</a> Promises</h2> <p>A <code>Promise</code> is a primary structure to be used with asynchronous programming.</p> <p>You already have good references for <code>Promise</code> and asynchronous programming in the MAD9014 notes. <a href="https://mad9014.github.io/f2023/modules/browser-js/week9/promises/" target="_blank" rel="noopener noreferrer">Module 9.1<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> and
<a href="https://mad9014.github.io/f2023/modules/browser-js/week9/async/" target="_blank" rel="noopener noreferrer">Module 9.2<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> explain Promises, async - await, and the event loop.</p> <div title="Tasks, Microtasks, and the Event Loop" class="video-player"><iframe width="560" height="315" src="https://www.youtube.com/embed/w-jULX0D5cg" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; fullscreen" allowfullscreen="allowfullscreen"></iframe></div> <p>When you create an event listener, the function is put aside in a holding area waiting to be told that the event has occurred. When the event happens, the function is moved into the task queue. The
next time around the event loop, the next task will get run. <code>setInterval</code> and <code>setTimeout</code> also use the task queue for their functions.</p> <p>Promises get added to another queue called the microtask queue. MutationObservers also use the microtask queue. The main differences between the task and microtask queue are the order that they are
called from the event loop, and that the microtask wants to empty all of its tasks before continuing, whereas the task queue runs one of its tasks per time through the event loop.</p> <p>This video gives a great explanation of the Event Loop.</p> <div title="Jake Archibald JSConf Event Loop" class="video-player"><iframe width="560" height="315" src="https://www.youtube.com/embed/cCOL7MC4Pl0" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; fullscreen" allowfullscreen="allowfullscreen"></iframe></div> <h3 id="async-await"><a href="#async-await" class="header-anchor">#</a> Async Await</h3> <p>The <code>async</code> and <code>await</code> keywords are a way of converting an ordinary function into one that can be paused to wait for the completion of one or more promises.</p> <p>Here is an example of a typical function. The log calls will happen in the order of the numbers - one, two , three.</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">basic</span><span class="token punctuation">(</span><span class="token parameter">url</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'one'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">fetch</span><span class="token punctuation">(</span>url<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'three'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'two'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p>With <code>async</code> and <code>await</code> you can tell the function that you might want to pause and wait for an asynchronous (Promise) call to be finished before proceeding.</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">basic</span><span class="token punctuation">(</span><span class="token parameter">url</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'one'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">await</span> <span class="token function">fetch</span><span class="token punctuation">(</span>url<span class="token punctuation">)</span><span class="token punctuation">;</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'three'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'two'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p>This version of the function would log the numbers as - one, three, two.</p> <h3 id="functions-and-promises"><a href="#functions-and-promises" class="header-anchor">#</a> Functions and Promises</h3> <p>When it comes to synchronous code things happen in a logical sequence. The first line of code runs first. Function calls run and complete before moving to the next line of code. In the following
example, the three variables <code>result1</code>, <code>result2</code>, <code>result3</code> will all be assigned a return value from the associated functions.</p> <div class="language-js line-numbers-mode"><div class="highlight-lines"><br><br><br><br><div class="highlighted"> </div><br><br></div><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">dosomething</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  <span class="token keyword">let</span> result1 <span class="token operator">=</span> <span class="token function">firstfunc</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">let</span> result2 <span class="token operator">=</span> <span class="token function">secondfunc</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">let</span> result3 <span class="token operator">=</span> <span class="token function">thirdfunc</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>result1<span class="token punctuation">,</span> result2<span class="token punctuation">,</span> result3<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p>This works and it is easy to see how. However, if any of those three functions are asynchronous then this will not work. The final line will run before the result is back from any asynchronous
function.</p> <p>If you ever need to test and check if a function is asynchronous, you can check to see what constructor was used to create the function. If a function is created with a signature like
<code>async function x(){ }</code> then you can use <code>x.constructor.name === 'AsyncFunction'</code> to test it.</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">dosomething</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> result1<span class="token punctuation">,</span> result2<span class="token punctuation">,</span> result3<span class="token punctuation">;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>firstfunc<span class="token punctuation">.</span>constructor<span class="token punctuation">.</span>name <span class="token operator">===</span> <span class="token string">'AsyncFunction'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    result1 <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">firstfunc</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
    result1 <span class="token operator">=</span> <span class="token function">firstfunc</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>secondfunc<span class="token punctuation">.</span>constructor<span class="token punctuation">.</span>name <span class="token operator">===</span> <span class="token string">'AsyncFunction'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    result2 <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">secondfunc</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
    result2 <span class="token operator">=</span> <span class="token function">secondfunc</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>thirdfunc<span class="token punctuation">.</span>constructor<span class="token punctuation">.</span>name <span class="token operator">===</span> <span class="token string">'AsyncFunction'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    result3 <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">thirdfunc</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
    result3 <span class="token operator">=</span> <span class="token function">thirdfunc</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>result1<span class="token punctuation">,</span> result2<span class="token punctuation">,</span> result3<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br></div></div><p>Technically, for this example you could just put <code>await</code> in front of each function call, regardless of whether or not it is an asynchronous one, but this won't always be the case. There may be times
when you need to know whether or not a function is asynchronous or not.</p> <p>Now, if you know that the function that you are calling is going to return a <code>Promise</code>, then you can write your code to address that.</p> <p>Say you have several modules that you are importing to use and that they have a series of methods which will return a <code>Promise</code>.</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> getPeopleFromDatabase <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'db.js'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> getImagesFromCache <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'cache.js'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> getInfoFromAPI <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'api.js'</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>Each of those methods will return a <code>Promise</code>. A <code>Promise</code> will either <code>resolve</code> or <code>reject</code>. It will either work or fail with an error. That means we have to wrap everything in a
<code>try{ }catch(err){ }</code> OR we can chain the calls together in a series of <code>then()</code> methods with a single <code>catch()</code> at the end.</p> <p>Just decide on the order that you need these methods to run.</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">doSomething</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token function">getPeopleFromDatabase</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">resultFromDB</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token comment">//use the results from the DB</span>
      <span class="token keyword">return</span> <span class="token function">getInfoFromAPI</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">resultFromAPI</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token comment">//use the results from the API</span>
      <span class="token keyword">return</span> <span class="token function">getImagesFromCache</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">resultFromCache</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token comment">//use the results from the cache</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">catch</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">err</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token comment">//handle the error from one of the promises</span>
      <span class="token keyword">switch</span> <span class="token punctuation">(</span>err<span class="token punctuation">.</span>name<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">case</span> <span class="token string">'DBError'</span><span class="token operator">:</span>
          <span class="token comment">//handle an error from the DB</span>
          <span class="token keyword">break</span><span class="token punctuation">;</span>
        <span class="token keyword">case</span> <span class="token string">'APIError'</span><span class="token operator">:</span>
          <span class="token comment">//special error from the API call</span>
          <span class="token keyword">break</span><span class="token punctuation">;</span>
        <span class="token keyword">case</span> <span class="token string">'CacheError'</span><span class="token operator">:</span>
          <span class="token comment">//special error from the Cache call</span>
          <span class="token keyword">break</span><span class="token punctuation">;</span>
        <span class="token keyword">case</span> <span class="token string">'Error'</span><span class="token operator">:</span>
        <span class="token comment">//a general JavaScript error</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br></div></div><p>The <code>catch</code> method in the code above is looking at the <code>name</code> property of the error object. JavaScript has a series of built-in error types - <code>EvalError</code>, <code>InternalError</code>, <code>RangeError</code>,
<code>ReferenceError</code>, <code>SyntaxError</code>, <code>TypeError</code>, and <code>URIError</code>. These are all built on top of the base <code>Error</code> object.</p> <p>If you want, you can create your OWN error types to use in your code.</p> <p>The JavaScript Class syntax is an easy way to do this. Here is an example of how to create your own custom error.</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">class</span> <span class="token class-name">HungryError</span> <span class="token keyword">extends</span> <span class="token class-name">Error</span> <span class="token punctuation">{</span>
  thirstyToo<span class="token punctuation">;</span>
  message <span class="token operator">=</span> <span class="token string">''</span><span class="token punctuation">;</span>

  <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token parameter">message<span class="token punctuation">,</span> thirstyToo <span class="token operator">=</span> <span class="token boolean">false</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">super</span><span class="token punctuation">(</span><span class="token string">'HungryError'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//the name property</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>message <span class="token operator">=</span> message<span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>thirstyToo <span class="token operator">=</span> thirstyToo<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">export</span> <span class="token punctuation">{</span> HungryError <span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><p>This <code>HungryError</code> has the <code>name</code> property which gets saved via the <code>Error</code> class. Then it saves the <code>message</code> in an instance variable belonging to the <code>HungryError</code> object that you create. The thing
that differentiates <code>HungryError</code> from the basic <code>Error</code> is the <code>thirstyToo</code> property.</p> <p>If you want to use this error in a file that you create...</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> HungryError <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'hungry-error.js'</span><span class="token punctuation">;</span>

<span class="token keyword">function</span> <span class="token function">dosomething</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">try</span> <span class="token punctuation">{</span>
    <span class="token comment">//do some things</span>
    <span class="token comment">//pretend that it fails</span>
    <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">HungryError</span><span class="token punctuation">(</span><span class="token string">'Too hungry to code'</span><span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>err<span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//HungryError</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>err<span class="token punctuation">.</span>message<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//Too hungry to code</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>err<span class="token punctuation">.</span>thirstyToo<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//true</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><h3 id="promise-methods"><a href="#promise-methods" class="header-anchor">#</a> Promise Methods</h3> <p>Any time that you want to deal with multiple promises at the same time any you don't want to take the next step in your code before ALL the promises have resolved, then you can use one of these
methods - <code>all</code>, <code>race</code>, <code>allSettled</code>, and <code>any</code>.</p> <ul><li><code>all</code> waits for all of the Promises to be resolved or rejects when the first one is rejected.</li> <li><code>allSettled</code> waits for all the Promises to be resolved or rejected. Provides array of all results and errors. Rejects if ALL the promises are rejected.</li> <li><code>race</code> waits for the first response (resolve or reject) to call <code>then</code> or <code>catch</code>.</li> <li><code>any</code> waits for the first successful resolve. Only rejects if all the promises fail.</li></ul> <p>For <code>all</code> and <code>allSettled</code> you will have an array of results passed to the <code>.then(results=&gt;{})</code>.</p> <p>For <code>race</code> and <code>any</code> you will get the one result, just like calling a single Promise.</p> <p>When you get an array of results from <code>all</code> or <code>allSettled</code>, each of the values in the array is an object with two main properties - <code>status</code> and <code>value</code>. Inside the <code>then</code> method, all the <code>status</code>
values will be <code>fulfilled</code>. The <code>value</code> properties will be the actual object returned by the promise. For example, with a call to <code>fetch()</code>, the <code>value</code> will be a <code>Response</code> object.</p> <p>Remember to view <a href="https://mad9014.github.io/f2023/modules/browser-js/week9/promises/#promises" target="_blank" rel="noopener noreferrer">the MAD9014 promise content<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> for more information.</p> <h2 id="fetch"><a href="#fetch" class="header-anchor">#</a> Fetch</h2> <p>This video covers everything that you need to know about using the Fetch API.</p> <p>Watch this video this week. Refer back to it as a reference when working with <code>Fetch</code>, <code>Request</code> objects, <code>Response</code> objects, and <code>URL</code> objects.</p> <div title="Ten Steps to Mastering Fetch" class="video-player"><iframe width="560" height="315" src="https://www.youtube.com/embed/2sQ9xiEAXNo" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; fullscreen" allowfullscreen="allowfullscreen"></iframe></div> <h3 id="requests-and-responses"><a href="#requests-and-responses" class="header-anchor">#</a> Requests and Responses</h3> <p>As files are passed back and forth between the browser and the server, they need to be wrapped inside a <code>Request</code> or <code>Response</code> object. Each of these objects have a <code>body</code> property which holds the
file.</p> <p>The <code>Request</code> object gets a <code>String</code> value, or <code>FormData</code> object, or a <code>File</code> object assigned to the <code>body</code> property.</p> <p>The <code>Response</code> object needs to use a method to extract the file from the <code>body</code> property. The most common methods are <code>text()</code>, <code>json()</code>, or <code>blob()</code>, which are used for HTML/XML, JSON, or media
files.</p> <p>The <code>Response</code> object also has an <code>ok</code> property which is a Boolean indicating success receiving a response with a status code between 200 and 299. The <code>status</code> and <code>statusText</code> properties tell you the
exact status of the response.</p> <p>If you want details about the contents of the response your best option is the <code>headers</code> property, which has a <code>get</code> method. It can be passed the name of any header and it will return the value of
that header.</p> <h3 id="json-vs-js"><a href="#json-vs-js" class="header-anchor">#</a> JSON vs JS</h3> <p>JSON and JavaScript are both text file types - <code>application/json</code> and <code>text/javascript</code>.</p> <p>The difference is that the first is a data format (just data) and the latter is a file format that is read and interpreted by a JavaScript engine such as V8.</p> <p>When writing objects in JS, the keys are only allowed to be strings. The quotation marks can be omitted for the keys. The quotation marks for the values can be single, double, or backticks. JavaScript
allows for trailing commas, comments, and expects variables to be declared to hold the values.</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">//this is a comment about some data</span>
<span class="token comment">//this is an array of objects</span>
<span class="token keyword">const</span> data <span class="token operator">=</span> <span class="token punctuation">[</span>
  <span class="token punctuation">{</span> <span class="token literal-property property">id</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">'Sam'</span><span class="token punctuation">,</span> <span class="token literal-property property">email</span><span class="token operator">:</span> <span class="token string">'sam@work.org'</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">{</span> <span class="token literal-property property">id</span><span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">'Dean'</span><span class="token punctuation">,</span> <span class="token literal-property property">email</span><span class="token operator">:</span> <span class="token string">'dean@work.org'</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">{</span> <span class="token literal-property property">id</span><span class="token operator">:</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">'Cas'</span><span class="token punctuation">,</span> <span class="token literal-property property">email</span><span class="token operator">:</span> <span class="token string">'cas@work.org'</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">]</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p>The JSON version of the same information would look very similar. All the quotation marks need to be double quotes. No comments are allowed. No trailing commas are allowed.</p> <div class="language-json line-numbers-mode"><pre class="language-json"><code><span class="token punctuation">[</span>
  <span class="token punctuation">{</span> <span class="token property">&quot;id&quot;</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;Sam&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;email&quot;</span><span class="token operator">:</span> <span class="token string">&quot;sam@work.org&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">{</span> <span class="token property">&quot;id&quot;</span><span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;Dean&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;email&quot;</span><span class="token operator">:</span> <span class="token string">&quot;dean@work.org&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">{</span> <span class="token property">&quot;id&quot;</span><span class="token operator">:</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;Cas&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;email&quot;</span><span class="token operator">:</span> <span class="token string">&quot;cas@work.org&quot;</span> <span class="token punctuation">}</span>
<span class="token punctuation">]</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>JSON is just one type of data file. Text data can be saved as <code>json</code>, <code>txt</code>, <code>xml</code>, <code>csv</code>, <code>html</code>, <code>tsv</code>, or other formats. The purpose of any of these formats is just to be able to transfer
information between different computers or between different computers.</p> <p>Web Services largely work by sending information back and forth as these files.</p> <p>Some Web Services also use web sockets to transfer data as a stream. But that's a topic for another day.</p> <h3 id="url-objects"><a href="#url-objects" class="header-anchor">#</a> URL objects</h3> <p>The <code>fetch</code> method can accept three different types of initial arguments.</p> <ol><li>A <code>String</code> which is a url.</li> <li>A <code>URL</code> object built from a string.</li> <li>A <code>Request</code> object that contains a <code>URL</code> object.</li></ol> <p>If you pass a <code>String</code> to the <code>fetch</code> method, it will wrap that in a <code>URL</code> which will in turn be wrapped in a <code>Request</code> object.</p> <p>The <code>Request</code> object has a <code>url</code> property that contains the <code>URL</code> object.</p> <p>The benefit of using a <code>Request</code> instead of a <code>String</code> is that the <code>Request</code> has already divided the string url into a series of properties that represent each of the parts of the url, like
<code>protocol</code>, <code>pathname</code>, <code>host</code>, etc.</p> <p>The other benefit that you get with a <code>URL</code> object is the ability to create a <code>URL</code> that points to some data in memory. Let's say that you do a fetch for an image. The <code>Response</code> object back from the
server will contain the binary data for the image.</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">let</span> blobData <span class="token operator">=</span> <span class="token keyword">await</span> myImageResponseObject<span class="token punctuation">.</span><span class="token function">blob</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> url <span class="token operator">=</span> <span class="token constant">URL</span><span class="token punctuation">.</span><span class="token function">createObjectURL</span><span class="token punctuation">(</span>blobData<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> img <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">'img'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
img<span class="token punctuation">.</span>src <span class="token operator">=</span> url<span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>The binary data can then be passed to the <code>URL.createObjectURL()</code> method which will generate a <code>URL</code> that points to the memory location with that binary data. The <code>URL</code> can then be used by elements
like <code>&lt;img&gt;</code> to load the image data.</p> <h3 id="files"><a href="#files" class="header-anchor">#</a> Files</h3> <p>File objects represent files from your operating system as well as files that are in a <code>Request</code> or <code>Response</code> object.</p> <p>A user can pass a file to the browser through an <code>&lt;input type=&quot;file&quot; /&gt;</code> element. There is also a new system <code>Origin Private File System</code> (OPFS) designed to allow for access to the device file system.
However, it does NOT have full support across all browsers. So, this leaves us with the input element approach.</p> <p>The <code>input</code> element has an <code>accept</code> attribute that allows you to filter the types of files that you are willing to accept. If added, the <code>multiple</code> attribute lets the user select more than one file at
a time.</p> <div class="language-html line-numbers-mode"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>form</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>myForm<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>file<span class="token punctuation">&quot;</span></span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>avatarID<span class="token punctuation">&quot;</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>avatarNM<span class="token punctuation">&quot;</span></span> <span class="token attr-name">accept</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>image/*, audio/*<span class="token punctuation">&quot;</span></span> <span class="token attr-name">multiple</span> <span class="token attr-name">required</span> <span class="token punctuation">/&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>form</span><span class="token punctuation">&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>In JavaScript, the input element will always have a <code>file</code> property that holds a <code>FileList</code> object. It has this list regardless of how many files the user picks.</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">let</span> form <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">'myForm'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//there are different ways to access the elements</span>
form<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">'submit'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">ev</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> input<span class="token punctuation">;</span>
  input <span class="token operator">=</span> form<span class="token punctuation">.</span>elements<span class="token punctuation">.</span>avatarNM<span class="token punctuation">;</span>
  input <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">'avatarID'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">let</span> filelist <span class="token operator">=</span> input<span class="token punctuation">.</span>files<span class="token punctuation">;</span>
  <span class="token comment">//filelist is an array of files.</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>filelist<span class="token punctuation">.</span>length <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">//at least one file submitted</span>
    <span class="token keyword">let</span> fileOne <span class="token operator">=</span> filelist<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>fileOne<span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>fileOne<span class="token punctuation">.</span>type<span class="token punctuation">)</span><span class="token punctuation">;</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>fileOne<span class="token punctuation">.</span>size<span class="token punctuation">)</span><span class="token punctuation">;</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>fileOne<span class="token punctuation">.</span>lastModified<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br></div></div><p>If you want to build your own <code>File</code> object you can do that with the <code>new File(fileBits, fileName, options)</code> constructor. Only the filebits is a required parameter. It needs to be an Iterable object
like an Array, TypedArray, or Blob. The <code>filename</code> is what you want to use as the name of the file and the <code>options</code> is usually the mime-type, like <code>application/json</code> or <code>text/xml</code> or <code>image/jpg</code>.</p> <p>If you want to create a JSON file, you can take a JavaScript object, convert it to a JSON string with <code>JSON.stringify()</code> and then pass that string to the File constructor, wrapped in an Array.</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">let</span> data <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">hello</span><span class="token operator">:</span> <span class="token string">'world'</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> str <span class="token operator">=</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> f <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">File</span><span class="token punctuation">(</span><span class="token punctuation">[</span>str<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token string">'mydata.json'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> <span class="token literal-property property">type</span><span class="token operator">:</span> <span class="token string">'application/json'</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><div title="Handling Files for Web Apps" class="video-player"><iframe width="560" height="315" src="https://www.youtube.com/embed/zq2xD-xuIG4" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; fullscreen" allowfullscreen="allowfullscreen"></iframe></div> <p><a href="https://developer.mozilla.org/en-US/docs/Web/API/File" target="_blank" rel="noopener noreferrer">File object reference<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p><a href="https://developer.mozilla.org/en-US/docs/Web/API/Blob" target="_blank" rel="noopener noreferrer">Blob object reference<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <h2 id="todo-this-week"><a href="#todo-this-week" class="header-anchor">#</a> ToDo This Week</h2> <div class="custom-block danger"><p class="custom-block-title">To Do this week</p> <ul><li>read all the content for modules 1.1 and 1.2</li> <li>start reading the Hybrid content and working on the Hybrid exercises</li> <li>Watch the <a href="https://www.youtube.com/watch?v=2sQ9xiEAXNo" target="_blank" rel="noopener noreferrer">YouTube Fetch Video<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div></div> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">Last Updated:</span> <span class="time">1/15/2024, 3:06:04 PM</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/s2024/modules/hybrids/exercises.html" class="prev">
        Hybrid Exercises
      </a></span> <span class="next"><a href="/s2024/modules/pwas/week1/1.2/">
        1.2: Git &amp; Pull Requests
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"><!----></div></div>
    <script src="/s2024/assets/js/app.800de6cb.js" defer></script><script src="/s2024/assets/js/2.65264708.js" defer></script><script src="/s2024/assets/js/32.ae206ed9.js" defer></script><script src="/s2024/assets/js/9.005e1e8c.js" defer></script><script src="/s2024/assets/js/11.87711128.js" defer></script>
  </body>
</html>
